[gd_scene load_steps=5 format=3 uid="uid://ct0p23jhd0i8v"]

[ext_resource type="Script" path="res://scripts/character_controller.gd" id="1_4s2f6"]
# [ext_resource type="Texture2D" path="res://assets/sprites/characters/Alice_Chen.png" id="2_3h5bg"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_1"]
size = Vector2(32, 48)

[sub_resource type="CircleShape2D" id="CircleShape2D_1"]
radius = 50.0

[sub_resource type="Theme" id="Theme_1"]

[node name="AICharacter" type="CharacterBody2D"]
script = ExtResource("1_4s2f6")
character_name = "Alice"
personality = "Friendly and curious resident"
move_speed = 100.0
interaction_range = 50.0

[node name="Sprite2D" type="Sprite2D" parent="."]
# texture = ExtResource("2_3h5bg")  # Assign character texture here
centered = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_1")

[node name="InteractionArea" type="Area2D" parent="."]

[node name="InteractionShape" type="CollisionShape2D" parent="InteractionArea"]
shape = SubResource("CircleShape2D_1")
debug_color = Color(0, 1, 0, 0.2)

[node name="NameLabel" type="Label" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -30.0
offset_top = -35.0
offset_right = 30.0
offset_bottom = -20.0
text = "Alice"
horizontal_alignment = 1
vertical_alignment = 1
theme = SubResource("Theme_1")

[node name="ThoughtBubble" type="Control" parent="."]
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -60.0
offset_top = -80.0
offset_right = 60.0
offset_bottom = -40.0

[node name="BubbleBackground" type="NinePatchRect" parent="ThoughtBubble"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
color = Color(1, 1, 1, 0.9)

[node name="ThoughtText" type="RichTextLabel" parent="ThoughtBubble"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 5.0
offset_top = 5.0
offset_right = -5.0
offset_bottom = -5.0
text = "I'm thinking..."
fit_content = true
scroll_active = false

[node name="BubbleTimer" type="Timer" parent="ThoughtBubble"]
wait_time = 3.0
one_shot = true

[node name="EmotionIndicator" type="ColorRect" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 20.0
offset_top = -25.0
offset_right = 28.0
offset_bottom = -17.0
color = Color(1, 1, 1, 0.8)

[node name="StatusUI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -40.0
offset_top = 20.0
offset_right = 40.0
offset_bottom = 50.0
visible = false

[node name="EnergyBar" type="ProgressBar" parent="StatusUI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 0.3
value = 100.0
show_percentage = false

[node name="HungerBar" type="ProgressBar" parent="StatusUI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_top = 0.35
anchor_bottom = 0.65
modulate = Color(1, 0.5, 0, 1)
value = 0.0
show_percentage = false

[node name="SocialBar" type="ProgressBar" parent="StatusUI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_top = 0.7
anchor_bottom = 1.0
modulate = Color(0, 0.5, 1, 1)
value = 50.0
show_percentage = false

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="."]
path_desired_distance = 4.0
target_desired_distance = 4.0
path_max_distance = 10.0
navigation_layers = 1

[node name="StateLabel" type="Label" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -40.0
offset_top = 30.0
offset_right = 40.0
offset_bottom = 45.0
text = "idle"
horizontal_alignment = 1
vertical_alignment = 1
visible = false

[connection signal="body_entered" from="InteractionArea" to="." method="_on_character_entered_range"]
[connection signal="body_exited" from="InteractionArea" to="." method="_on_character_exited_range"]
[connection signal="timeout" from="ThoughtBubble/BubbleTimer" to="." method="_on_bubble_timer_timeout"]